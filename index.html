<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>XCard â€“ Print Safe MVP</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>

/* ================= THEME ================= */

:root{
  --primary:#2563eb;
  --primary-dark:#1e40af;
  --bg:#f8fafc;
  --panel:#ffffff;
  --text:#0f172a;
  --border:#e5e7eb;
  --active:#22c55e;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:Inter,sans-serif;
  background:var(--bg);
  color:var(--text);
  width:100%;
  overflow-x:hidden;
}

/* ================= HEADER ================= */

header{
  background:linear-gradient(135deg,var(--primary),var(--primary-dark));
  color:white;
  padding:10px;
  text-align:center;
}

header h1{
  margin:0;
  font-size:18px;
}

header p{
  margin:2px 0 0;
  font-size:11px;
  opacity:.85;
}

/* ================= LAYOUT ================= */

.container{
  width:100%;
  max-width:1200px;
  margin:0 auto;
  padding:10px;
}

.panel{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:8px;
  padding:10px;
  margin-bottom:10px;

  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:center;

  width:100%;
}

.panel h3{
  width:100%;
  margin:0 0 4px;
  font-size:12px;
  color:var(--primary);
}

/* ================= FORM ================= */

input,textarea,button{
  font-family:inherit;
  font-size:12px;
}

input,textarea{
  padding:5px 7px;
  border-radius:5px;
  border:1px solid var(--border);
  width:100%;
}

textarea{
  min-height:45px;
  resize:vertical;
}

.panel input[type="number"]{
  max-width:70px;
}

/* ================= BUTTONS ================= */

button{
  background:var(--primary);
  color:white;
  border:none;
  border-radius:5px;
  padding:6px 10px;
  font-size:11px;
  font-weight:600;
  cursor:pointer;
}

button:hover{ background:var(--primary-dark); }

button.secondary{
  background:#e5e7eb;
  color:var(--text);
}

button.active{
  background:var(--active)!important;
}

button.danger{
  background:#dc2626;
}

/* ================= UPLOAD ROW ================= */

.upload-row{
  display:flex;
  gap:8px;
  width:100%;
  flex-wrap:wrap;
}

.upload-row input[type="file"]{
  flex:1;
  min-width:140px;
}

/* ================= GRID ================= */

.cards-container{
  width:100%;
  display:grid;
  gap:12px;
  justify-items:center;

  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
}

/* ================= CARD ================= */

.card{
  width:100%;
  max-width:220px;
}

.card-inner{
  width:100%;
  aspect-ratio:1/1;

  position:relative;
}

/* Faces */

.face{
  position:absolute;
  inset:0;

  border-radius:10px;

  padding:12px;

  display:flex;
  justify-content:center;
  align-items:center;

  text-align:center;

  font-size:12px;
  font-weight:600;

  box-shadow:0 3px 6px rgba(0,0,0,.08);
}

.card-front{
  background:white;
}

.card-back{
  background:#0f172a;
  color:white;
  display:none;
}

/* Number */

.number{
  position:absolute;
  top:5px;
  left:5px;

  background:var(--primary);
  color:white;

  font-size:10px;
  padding:1px 5px;
  border-radius:4px;
}

/* ================= MODES ================= */

/* Front Mode */
.front-only .card-front{ display:flex; }
.front-only .card-back{ display:none; }

/* Back Mode */
.back-only .card-front{ display:none; }
.back-only .card-back{ display:flex; }

/* Both Mode */
.both-mode .card-front{ display:flex; }
.both-mode .card-back{ display:none; }

/* ================= PRINT ================= */

@media print{

  @page{
    size:A4 portrait;
    margin:5mm;
  }

  header,.panel{
    display:none;
  }

  body{
    background:white;
  }

  /* Always print FRONT only */
  .card-front{
    display:flex!important;
  }

  .card-back{
    display:none!important;
  }

  .face{
    box-shadow:none;
  }
}

</style>
</head>

<body class="both-mode">

<header>
  <h1>XCard</h1>
  <p>Print Safe Flashcard Generator</p>
</header>

<div class="container">

<!-- DISPLAY -->

<div class="panel">

  <h3>Display</h3>

  Cols <input type="number" id="cols" value="3" min="1" max="6">
  Size <input type="number" id="size" value="200">
  Gap <input type="number" id="gap" value="10">

  <button onclick="autoFit()">Fit</button>
  <button onclick="applySettings()">Apply</button>

  <button id="btnFront" class="secondary" onclick="showFront()">Front</button>
  <button id="btnBack" class="secondary" onclick="showBack()">Back</button>
  <button id="btnBoth" class="secondary active" onclick="showBoth()">Both</button>

  <button onclick="printSafe()">Print</button>

</div>

<!-- ADD -->

<div class="panel">

  <h3>Add Card</h3>

  <textarea id="frontText" placeholder="Front"></textarea>
  <textarea id="backText" placeholder="Back"></textarea>

  <button onclick="addCard()">Add</button>

</div>

<!-- UPLOAD -->

<div class="panel">

  <h3>Uploads</h3>

  <textarea id="bulkInput" placeholder="Bulk: Q|A"></textarea>

  <button onclick="importBulk()">Bulk Import</button>

  <div class="upload-row">

    <input type="file"
           accept=".csv,.json"
           onchange="handleFile(event)">

    <button class="secondary"
            onclick="openGoogleDrive()">
      Google Drive
    </button>

  </div>

</div>

<!-- PRESET -->

<div class="panel">

  <h3>Presets</h3>

  <input id="presetName" placeholder="Preset name">

  <button onclick="savePreset()">Save</button>
  <button onclick="loadPreset()">Load</button>

  <button class="danger" onclick="clearAll()">Clear</button>

</div>

<!-- CARDS -->

<div id="cardsContainer" class="cards-container"></div>

</div>


<script>

/* ================= DATA ================= */

let cardsData=[
  {front:"What is DI?",back:"Dependency Injection"},
  {front:"What is REST?",back:"API Architecture"}
];

/* ================= UTIL ================= */

const el=id=>document.getElementById(id);
const val=id=>el(id).value;
const set=(id,v)=>el(id).value=v;

/* ================= RENDER ================= */

function renderCards(){

  const box=el("cardsContainer");
  box.innerHTML="";

  cardsData.forEach((c,i)=>{

    const d=document.createElement("div");
    d.className="card";

    d.innerHTML=`

      <div class="card-inner">

        <div class="face card-front">
          <div class="number">${i+1}</div>
          ${c.front}
        </div>

        <div class="face card-back">
          <div class="number">${i+1}</div>
          ${c.back}
        </div>

      </div>
    `;

    box.appendChild(d);
  });

  applySettings();
}

/* ================= SETTINGS ================= */

function applySettings(){

  const cols=val("cols");
  const size=val("size");
  const gap=val("gap");

  const grid=el("cardsContainer");

  grid.style.gridTemplateColumns=
    `repeat(${cols}, minmax(180px,1fr))`;

  grid.style.gap=gap+"px";

  document.querySelectorAll(".card")
    .forEach(c=>{
      c.style.maxWidth=size+"px";
    });
}

function autoFit(){

  set("cols",3);
  set("size",180);
  set("gap",10);

  applySettings();
}

/* ================= ADD ================= */

function addCard(){

  const f=el("frontText").value.trim();
  const b=el("backText").value.trim();

  if(!f||!b) return alert("Fill both fields");

  cardsData.push({front:f,back:b});

  el("frontText").value="";
  el("backText").value="";

  renderCards();
}

/* ================= BULK ================= */

function importBulk(){

  const t=el("bulkInput").value.trim();
  if(!t) return;

  t.split("\n").forEach(l=>{

    if(!l.includes("|")) return;

    const p=l.split("|");

    cardsData.push({
      front:p[0].trim(),
      back:p.slice(1).join("|").trim()
    });
  });

  el("bulkInput").value="";

  renderCards();
}

/* ================= FILE ================= */

function handleFile(e){

  const file=e.target.files[0];
  if(!file) return;

  const ext=file.name.split(".").pop().toLowerCase();

  if(ext!=="csv"&&ext!=="json"){
    alert("Only CSV or JSON allowed");
    e.target.value="";
    return;
  }

  if(ext==="csv") loadCSV(file);
  if(ext==="json") loadJSON(file);
}

function loadCSV(file){

  const r=new FileReader();

  r.onload=x=>{

    x.target.result
      .split("\n")
      .slice(1)
      .forEach(l=>{

        const [f,b]=l.split(",");

        if(f&&b)
          cardsData.push({
            front:f.trim(),
            back:b.trim()
          });
      });

    renderCards();
  };

  r.readAsText(file);
}

function loadJSON(file){

  const r=new FileReader();

  r.onload=x=>{

    try{

      const data=JSON.parse(x.target.result);

      if(!Array.isArray(data)) throw"bad";

      data.forEach(i=>{

        if(i.front&&i.back)
          cardsData.push({
            front:i.front,
            back:i.back
          });
      });

      renderCards();

    }catch{
      alert("Invalid JSON");
    }
  };

  r.readAsText(file);
}

/* ================= DRIVE ================= */

function openGoogleDrive(){

  alert("Google Drive integration requires OAuth.");

  window.open("https://drive.google.com","_blank");
}

/* ================= PRESET ================= */

function savePreset(){

  const name=el("presetName").value.trim();
  if(!name) return alert("Enter name");

  const data={
    cards:cardsData,
    settings:{
      cols:val("cols"),
      size:val("size"),
      gap:val("gap")
    }
  };

  localStorage.setItem(name,JSON.stringify(data));

  alert("Saved");
}

function loadPreset(){

  const name=el("presetName").value.trim();

  const d=localStorage.getItem(name);
  if(!d) return alert("Not found");

  const obj=JSON.parse(d);

  cardsData=obj.cards;

  set("cols",obj.settings.cols);
  set("size",obj.settings.size);
  set("gap",obj.settings.gap);

  renderCards();
}

/* ================= MODES ================= */

function activate(btn){

  ["btnFront","btnBack","btnBoth"].forEach(id=>{
    el(id).classList.remove("active");
  });

  btn.classList.add("active");
}

function showFront(){

  document.body.className="front-only";

  activate(el("btnFront"));
}

function showBack(){

  document.body.className="back-only";

  activate(el("btnBack"));
}

function showBoth(){

  document.body.className="both-mode";

  activate(el("btnBoth"));
}

/* ================= PRINT ================= */

// function printSafe(){

//   // Force front mode for printing
//   // document.body.className="front-only";

  
//   setTimeout(()=>{
//     window.print();
//   },500);

  // activate(el("btnFront"));
// }
function printSafe(){
window.print();
  // document.body.classList.remove("back-preview");

  // setTimeout(()=>{
  //   window.print();
  // },200);
}

/* ================= CLEAR ================= */

function clearAll(){

  if(!confirm("Clear all cards?")) return;

  cardsData=[];
  renderCards();
}

/* ================= INIT ================= */

showBoth();
renderCards();

</script>

</body>
</html>
